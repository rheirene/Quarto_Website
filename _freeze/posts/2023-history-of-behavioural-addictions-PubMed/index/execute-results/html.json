{
  "hash": "e291dae3c0eb9d1302fd68c106515fbb",
  "result": {
    "markdown": "---\ntitle: \"The history of behavioural addictions research (according to PubMed)\"\ndescription: \"\"\nauthor:\n  - name: Rob Heirene\ncategories: [Gambling] \ndate: 2023-08-25\ndraft: true \n---\n\n\nThe world of behavioural addictions research is a strange place.\n\n### Data & code set-up\n\nOkay, so let's get started with exploring the data. I'll first load all the required packages and fonts for figures.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: set-up\"}\n# Install and load the groundhog package to ensure consistency of the package versions used here:\n# install.packages(\"groundhog\") # Install\n\nlibrary(groundhog) # Load\n\n# List desired packages:\npackages <- c('readr', # Load dataset from GitHib\n              'RCurl', # Load dataset from GitHib\n              'tidyverse', # Clean, organise, and visualise data\n              'gt', #  table data\n              'gtExtras', # Add colours to gt tables\n              'plotly', # Add interactive elements to figures\n              'gganimate', # Make animated plots\n              'transformr', # Needed for certain animations (dumbell lines)\n              'png',# Helps render gganimate plots\n              'gifski', # Helps render gganimate plots\n              'rmarkdown', # Helps render gganimate plots\n              'av', # render gganimate plots as videos\n              'Cairo', # Anti-aliasing for the line plots (smoothing output)\n              'ggtext', # make fancy labels in plots\n              'sysfonts', # Special fonts for figures\n              'showtext', # Special fonts for figures\n              'htmlwidgets', # Make plotly plots HTML format for rendering in Quarto\n              'scico', # Colour palette\n              'sessioninfo') # Detailed session info for reproducibility \n\n# Load desired package with versions specific to project start date:\ngroundhog.library(packages, \"2023-08-01\") \n\n# Load new font for figures/graphs\nfont_add_google(\"Poppins\", \"Poppins\")\nfont_add_google(\"Reem Kufi\", \"Reem Kufi\")\nshowtext_auto(enable = TRUE) \n\n\nplot_theme <-  theme(plot.background = element_rect(fill = \"#002B36\",  color = NA), # ADDING THIS NA REMOVES BORDER AROUND PLOT ON WEBSITE\n     panel.background = element_rect(fill = \"#002B36\"),\n     text = element_text(family = \"Reem Kufi\", color = \"#F5F7F0\"),\n     axis.text = element_text(color = \"#F5F7F0\", size = 13),\n     panel.grid = element_blank(),\n     plot.title = element_text(color = \"#F5F7F0\", size = 16),\n     plot.subtitle = element_text(color = \"#289998\"),\n     plot.caption = element_text(color = \"#289998\"))\n```\n:::\n\n\nNow I'll load in the dataset and do a little cleaning. Of note, I'm going to remove all publications from 2023 so that we only have data for complete years (see comments in the code chunk below for any other exclusions).\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: load dataset\"}\nurl_behav_addic_data_link <- \"https://raw.githubusercontent.com/rheirene/pub-med-scape-behav-addictions/main/Data%20extraction/combined_results_clean.csv\"\n\nraw_data <- read_csv(url_behav_addic_data_link) %>%\n  as_tibble()\n\nstr(raw_data)\n# View(data)\n\n# Despite my best efforts with manual searching, my explorations of this dataset in R revealed that there are a few erratums/corrigendums and one notice of retraction included in the data. Let's remove these before moving forward:\nfiltered_data <- raw_data %>%\n  filter(str_detect(Publication_Type, \"Erratum\") | \n         str_detect(Publication_Type, \"corrigendum\") | \n         str_detect(Publication_Type, \"Retraction\")) %>% \n  distinct(PMID, .keep_all = TRUE)\n\n# Let's now remove these pubs and any from 2023 so we have data for all \"full\" years:\ndata <- raw_data %>% \n  anti_join(filtered_data) %>%\n    filter(Year != \"2023\") \n```\n:::\n\n\n\n\n### All behavioural \"addictions\" found\n\n::: {.callout-tip appearance=\"minimal\" icon=\"false\"}\n## Are these all \"true\" addictions?\n\nIn no way do I endorse\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata %>%\n  distinct(PMID, .keep_all = TRUE) %>%\n  group_by(Label) %>% \n  summarise(\n    n = n()\n  ) %>%\n  arrange(desc(n)) %>%\n      # Tidy the behavioural addiction labels:\n    mutate(Label = str_replace_all(Label, \"_\", \" \") %>%\n                 str_to_title()) %>%\n   gt() %>% \n   tab_header(\n    title = md(\"**Number of publications on PubMed**\"),\n    subtitle = md(\"*Up to end of 2022*\"))  %>%\n  gt_color_rows(n, palette = c(\"#002B36\", \"#289998\"))  %>%\n   tab_style(\n    style = cell_borders(sides = c(\"top\", \"bottom\"),\n                         color = \"#002B36\",\n                         weight = px(1.5),\n                         style = \"solid\"),\n    locations = cells_body()\n  ) %>%\n  tab_options(table.font.color = \"#289998\",\n              table.background.color = \"#002B36\",\n              table.border.bottom.color = \"#289998\",\n              table_body.border.bottom.color = \"#289998\") %>%\n  tab_style(\n      style = list(\n        cell_fill(color = \"#002B36\"),\n        cell_text(color = \"#F5F7F0\")\n      ),\n      locations = cells_body(columns = Label)\n    ) %>%\n  cols_align(align = \"center\", columns = n) %>%\n   cols_align(align = \"right\", columns = Label) %>%\n  tab_style(\n    style = cell_borders(sides = c(\"t\"),\n                         color = \"#289998\",\n                         weight = px(2)),\n    locations = list(cells_footnotes(), cells_source_notes())\n  ) %>%\n       cols_label(\n    Label = \"Behavioural addiction\",\n    n = \"N\") \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Domain not specified, defaulting to observed range within each\nspecified column.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Since gt v0.9.0, the `colors` argument has been deprecated.\n• Please use the `fn` argument instead.\nThis warning is displayed once every 8 hours.\n```\n:::\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"vqsizzsirk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vqsizzsirk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vqsizzsirk thead, #vqsizzsirk tbody, #vqsizzsirk tfoot, #vqsizzsirk tr, #vqsizzsirk td, #vqsizzsirk th {\n  border-style: none;\n}\n\n#vqsizzsirk p {\n  margin: 0;\n  padding: 0;\n}\n\n#vqsizzsirk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #FFFFFF;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #002B36;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #289998;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vqsizzsirk .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #002B36;\n  border-bottom-width: 0;\n}\n\n#vqsizzsirk .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #002B36;\n  border-top-width: 0;\n}\n\n#vqsizzsirk .gt_heading {\n  background-color: #002B36;\n  text-align: center;\n  border-bottom-color: #002B36;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vqsizzsirk .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vqsizzsirk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vqsizzsirk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vqsizzsirk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vqsizzsirk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vqsizzsirk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vqsizzsirk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vqsizzsirk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vqsizzsirk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vqsizzsirk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vqsizzsirk .gt_stub {\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vqsizzsirk .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #002B36;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vqsizzsirk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vqsizzsirk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vqsizzsirk .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #002B36;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vqsizzsirk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vqsizzsirk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #002B36;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vqsizzsirk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vqsizzsirk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #289998;\n}\n\n#vqsizzsirk .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #002B36;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vqsizzsirk .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #002B36;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vqsizzsirk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vqsizzsirk .gt_left {\n  text-align: left;\n}\n\n#vqsizzsirk .gt_center {\n  text-align: center;\n}\n\n#vqsizzsirk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vqsizzsirk .gt_font_normal {\n  font-weight: normal;\n}\n\n#vqsizzsirk .gt_font_bold {\n  font-weight: bold;\n}\n\n#vqsizzsirk .gt_font_italic {\n  font-style: italic;\n}\n\n#vqsizzsirk .gt_super {\n  font-size: 65%;\n}\n\n#vqsizzsirk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vqsizzsirk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vqsizzsirk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vqsizzsirk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vqsizzsirk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vqsizzsirk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vqsizzsirk .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal\" style><strong>Number of publications on PubMed</strong></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style><em>Up to end of 2022</em></td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Behavioural addiction\">Behavioural addiction</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N\">N</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Gambling</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #289998; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">3145</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Gaming</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #0C5159; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">1178</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Behavioural Addictions</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #07444D; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">795</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Smart Phone</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #054049; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">669</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Exercise</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #02353F; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">315</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Work</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #02323D; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">239</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Sex</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #01313C; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">208</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Social Media</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #01313B; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">192</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Pornography</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002C37; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">35</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Tanning</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002C37; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">24</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Study</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002C37; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">19</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Cybersex</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002C36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">18</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Running</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">9</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Love</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">8</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Extreme Sport</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">5</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Selfie</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">5</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Hair Pulling</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">3</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Crime</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">2</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Polysurgical</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">2</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Youtube</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">1</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Death</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">1</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Joyriding</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">1</td></tr>\n    <tr><td headers=\"Label\" class=\"gt_row gt_right\" style=\"border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36; background-color: #002B36; color: #F5F7F0;\">Near Death</td>\n<td headers=\"n\" class=\"gt_row gt_center\" style=\"background-color: #002B36; color: #FFFFFF; border-top-width: 1.5px; border-top-style: solid; border-top-color: #002B36; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: #002B36;\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n### Patterns over time\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Bar chart of total pubs\"}\n# Compute some summary values will use in the labels:\nn_papers_2022<- data %>%\n  distinct(PMID, .keep_all = TRUE) %>%\n  filter(Year == 2022) %>%\n  distinct(PMID) %>% \n  count() %>%\n  pull()\n\nn_journals_2022<- data %>%\n  distinct(PMID, .keep_all = TRUE) %>%\n  filter(Year == 2022) %>%\n  distinct(Journal_Title) %>% \n  count() %>%\n  pull()\n\n# Prepare data:\ndata_total_per_year_pubs <- data %>%\n   distinct(PMID, .keep_all = TRUE) %>%\n   filter(Year != \"2023\") %>%\n   group_by(Year) %>%\n   count() %>%\n   ungroup() %>%\n  mutate(first_study_1961_label = case_when(Year >= 1961 & Year < 1980 ~ sprintf(\"1961  \\nFirst available study: \\n\\\"Compulsive gambling\\\"\"),\n                               TRUE ~ \"\")) %>%\n  mutate(gam_1980_label = case_when(Year >= 1980 & Year < 1994 ~ sprintf(\"1980  \\nPathological Gambling added \\nto DSM (version III)\"),\n                               TRUE ~ \"\")) %>%\n  mutate(behav_addic_1994_label = case_when(Year >= 1994 & Year < 2004 ~ sprintf(\"1994  \\nFirst mention of \\\"Behavioural \\n addictions\\\" in the literature\"),\n                               TRUE ~ \"\")) %>%\n  mutate(first_gaming_2004_label = case_when(Year >= 2004 & Year < 2013 ~ sprintf(\"2004  \\nFirst available studies \\non gaming addiction\"),\n                               TRUE ~ \"\")) %>%\n  mutate(gam_DSMV_label = case_when(Year >= 2013 & Year < 2020 ~ sprintf(\"2013 \\n\\\"Gambling disorder\\\"\\nadded in \\\"addictive \\ndisorders\\\" class in \\nDSM-V\"),\n                               TRUE ~ \"\")) %>%\n  mutate(final_year_label = case_when(\n    Year >= 2020 & Year < 2023 ~ sprintf(\"2022 \\n%s studies\\n published \\nacross %s  \\njournals\", n_papers_2022, n_journals_2022),\n    TRUE ~ \"\"\n  ))                     \n                   \n # Make plot: \ntotal_year_gganimate <- data_total_per_year_pubs %>%\n   ggplot(aes(Year, n)) + \n   geom_point() + \n   geom_line(size = 1.1, color = \"#289998\") + \n  # Add year counting label\n   geom_text(aes(x = 1984, y = 370, label = as.factor(Year)), hjust = 0, vjust = 0, alpha = 0.6, col = \"#289998\", size = 15, family = \"Reem Kufi\") +\n  # Add 1961 first study label\n  geom_text(aes(x = 1961, y =90, label = first_study_1961_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n  # Add 1980 gambling label\n  geom_text(aes(x = 1970, y =100, label = gam_1980_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n  # Add 1994 behavioural addictions label\n  geom_text(aes(x = 1984, y =110, label = behav_addic_1994_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n  # Add 2004 gaming addiction label\n  geom_text(aes(x = 1994, y =150, label = first_gaming_2004_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n   # Add 2013 gambling label\n  geom_text(aes(x = 2002, y =260, label = gam_DSMV_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n  # Add final year label\n  geom_text(aes(x = 2014, y =670, label = final_year_label), hjust = 0, vjust = 0, alpha = 1, col = \"#F5F7F0\", size = 4, family = \"Reem Kufi\") +\n  # Define theme elements\n   theme(\n     plot.background = element_rect(fill = \"#002B36\",  color = NA), # ADDING THIS NA REMOVES BORDER AROUND PLOT ON WEBSITE\n     panel.background = element_rect(fill = \"#002B36\"),\n     text = element_text(family = \"Reem Kufi\", color = \"#F5F7F0\"),\n     axis.text = element_text(color = \"#F5F7F0\", size = 12),\n     panel.grid = element_blank(),\n     plot.margin = margin(20, 5, 20, 20),\n     axis.title.y = element_blank(),  # Adjust y-axis title position\n     axis.title.x = element_text(margin = margin(t = 18), size = 14),\n     plot.title = element_text(color = \"#F5F7F0\", size = 15, margin = margin(b = 10), hjust = -4),\n     plot.subtitle = element_text(color = \"#289998\", hjust = -0.02)\n     # panel.border = element_rect(color = \"#002B36\")\n   ) +\n  scale_x_continuous(breaks = seq(1960, 2020, by = 10), expand = c(.01, 0)) +  # Define x-axis dates & Make the plot fill the available space better\n  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 750, by = 250)) +  # Define y-axis labels\n  # Add titles and labels\n   labs(\n     title = \"Number of Behavioural Addictions papers published per year on PubMed\",  # Add header\n     subtitle = \"(Up to end of 2022)\",\n     x = \"Year\",\n     caption = \"Rob Heirene (@rheirene)\"\n   ) +\n  theme(plot.caption = element_text(color = \"#289998\",  hjust = .98,\n                                    vjust = .98)) +\n  # Add gganimate animation\n   transition_reveal(Year) \n      # view_follow()\n\n# Animate and present plot:\n# animate(\n#   total_year_gganimate,\n#   width = 700, height = 420, \n#         rewind = FALSE, \n#         type = \"cairo\",\n#   duration = 14,\n#   fps = 12,\n#   renderer = av_renderer()\n# )\n\n # Animate plot in GIF format:\nanimate(total_year_gganimate,\n        width = 700, height = 420,\n        end_pause = 30,\n        type = \"cairo\",\n        duration = 21)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.gif){fig-align='center'}\n:::\n:::\n\n\n\n\n \n\nHow many in the last 10 years alone?\n\nNow let's start to look publication rates for each \"addiction\" in our dataset.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Bar chart race (publications by addiction)\"}\n# Get palette colors\nnum_labels <- length(unique(data$Label))\npalette_colors <- rev(scico(n = num_labels, palette = 'imola'))\n\n# levels(as.factor(data$Label)) # Check out all behavioural addictions in the dataset\n\n# Prepare the data:\ndata_bar_chart_race_pubs_year<- data %>% \n  # Remove generic behav addictions category:\n  filter(Label != \"behavioural_addictions\") %>%\n    # Tidy the behavioural addiction labels:\n    mutate(Label = str_replace_all(Label, \"_\", \" \") %>%\n                 str_to_title()) %>%\n  # Aggregate the data by behavioural addiction type:\n  group_by(Year, Label) %>% \n  count() %>% \n  ungroup() %>%\n  group_by(Label) %>% \n  mutate(Accumulated_Papers = cumsum(n)) %>% # Produce a variable that is the cumulative sum of studies for each disorder each year (this is what we will be plotting)\n  # This next part is a bit clunky, but we need to find a way to have a value for every addiction for every year, even though we don't have one currently. We can do this by pivoting wider so we create a column for each year then go from there\n  ungroup() %>%\n  mutate(percent = round(n/sum(n)*100, 2))  %>% # just for interest\n  # mutate(Label = factor(Label, levels = unique(Label))) %>%  # order the Label by descending n\n    mutate(Year = paste0(\"label_\", Year)) %>% # so we can select columns later on easily\n  select(-n,\n         -percent) %>% # Remove these columns otherwise it throws off the pivot_longer below and makes multiple rows per date\n  pivot_wider(names_from = Year, values_from = Accumulated_Papers) %>% \n  mutate(label_1961 = case_when(label_1961 == 1 ~ 1,\n                                is.na(label_1961) ~ 0)) %>% # This sets the first year to 0 unless there is a paper published, allowing us to use this as a starting point for imputing values\n  pivot_longer(cols = starts_with(\"label_\"), names_to = \"Year\", values_to = \"Accumulated_Papers\") %>% # now put back into longer format\n  group_by(Label) %>%\n  fill(Accumulated_Papers, .direction = \"down\") %>% # Impute missing values from one above, by addiction type\n    mutate(Year = str_replace(Year, \"label_\", \"\"))  %>% # remove label from the year values\n   ungroup() %>%\n   group_by(Year) %>% \n  # Provide a rank for each addiction that ensures no overlap:\n arrange(Year, desc(Accumulated_Papers), Label) %>%\n  mutate(\n    Rank = row_number(),\n    Rank = ifelse(duplicated(Accumulated_Papers, fromLast = TRUE), Rank - 0.0001, Rank)\n  ) %>%\n  ungroup() \n\n\n# View(data_bar_chart_race_pubs_year) #  Check everything looks okay before proceeding!\n\n# Produce plot:\nbar_chart_race_pubs_year <- \n  data_bar_chart_race_pubs_year %>% \n      ggplot(aes(x = -Rank, y = Accumulated_Papers, fill = Label)) + \n    geom_tile(aes(y = Accumulated_Papers/2, height = Accumulated_Papers), \n              width = 0.9) + \n  coord_flip(clip = \"off\", expand = FALSE) + # Flip\n  # Add year counting label\n   geom_text(aes(y = 2400, x = -24, \n                 label = as.factor(Year)), \n             hjust = 0, vjust = 0, \n             alpha = 0.6, col = \"#289998\", # Alpha not working here for some unknown reason (send help!)\n             size = 14, family = \"Reem Kufi\",\n             inherit.aes = FALSE) + # Adding this didn't fix the alpha issue\n\n  # Add behavioural addiction label\n  geom_text(aes(x = -Rank, y = -100, \n                label = Label),\n            hjust = 1, \n            color = \"#F5F7F0\",\n            family = \"Reem Kufi\") + \n  # Add value label\n  geom_text(aes(y = Accumulated_Papers, \n              label = as.factor(Accumulated_Papers)), # Putting this as a factor is key otherwise it displays decimals to ~10 places at times!\n          hjust = -0.2,\n          color = \"#F5F7F0\",\n          fontface = \"bold\", \n          family = \"Reem Kufi\") +\n  # scale_y_continuous(limits = c(0,3800), breaks = seq(0, 3500, by = 500), expand = c(.01, 0)) +  # Define x-axis dates & Make the plot fill the available space\n    scale_fill_manual(values = palette_colors, guide = FALSE) +\n  theme(legend.position = \"none\") +\n theme(\n     plot.background = element_rect(fill = \"#002B36\",  color = NA), # ADDING THIS NA REMOVES BORDER AROUND PLOT ON WEBSITE\n     panel.background = element_rect(fill = \"#002B36\"),\n     text = element_text(family = \"Reem Kufi\", color = \"#F5F7F0\"),\n     axis.text = element_text(color = \"#F5F7F0\", size = 12),\n     panel.grid = element_blank(),\n     plot.margin = margin(10, 60, 20, 130),\n     axis.text.y = element_blank(), \n     axis.text.x = element_blank(),  # remove x-axis text\n     axis.title = element_blank(),   # remove x-axis title\n     plot.title = element_text(color = \"#F5F7F0\", size = 15, margin = margin(b = 10), hjust = 0.8),\n     plot.subtitle = element_text(color = \"#289998\", margin = margin(b = 17), hjust = -0.65),\n     plot.caption = element_text(color = \"#289998\",  hjust = 1.25,\n                                    vjust = 0.2)\n     # axis.text.y = element_text(size = 12, hjust = 1)\n     # panel.border = element_rect(color = \"#002B36\")\n   ) +\n  # Add titles and labels\n   labs(\n     title = \"Cumulative publications per \\\"addiction\\\" over time\",  # Add header\n     subtitle = \"(Up to end of 2022)\",\n     caption = \"Rob Heirene (@rheirene)\"\n   ) +\n  transition_states(Year, \n                    wrap = FALSE, # This (with some of the animation arguments) stops it from rewinding at the end\n                    transition_length = 5, \n                    state_length = 1) +\n   enter_grow() +\n  ease_aes('linear')\n\n# Animate in video format:\n# animate(bar_chart_race_pubs_year, \n#         fps = 20, \n#         end_pause = 50,\n#         duration = 30, \n#         rewind = FALSE,\n#         width = 600, height = 700,\n#         type = \"cairo\",\n#         renderer = av_renderer())\n\n\n# Animate plot in GIF format:\nanimate(bar_chart_race_pubs_year,\n        fps = 20,\n        end_pause = 70,\n        duration = 30,\n        width = 480, height = 670,\n        type = \"cairo\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.gif){fig-align='center'}\n:::\n:::\n\n\n\n\n \n\nWell that was fun, but it's actually quite difficult to see exactly what's going on at every year given how many different supposed addictions there are. Let's try another approach:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Dumbbell plot (publications by addiction)\"}\n# Arrange data:\ndumbbell_plot_data<- data %>%\n  # filter(Year != \"2023\") %>%\n  filter(Label != \"behavioural_addictions\") %>%\n  group_by(Label) %>% \n  summarise(\n    min = min(Year), # identify first year\n    max = max(Year), # identify last  year\n    min_papers = sum(Year == min(Year)),  # Count papers for first year\n    max_papers = sum(Year == max(Year))   # Count papers for last year\n  ) %>% \n  arrange(min) %>% \n  pivot_longer(cols = c(min, max),\n    names_to = \"Range\",\n    values_to = \"Year\"\n  ) %>%\n  # Compute a single column that contains our n papers for the first and last pub years:\n  mutate(papers_this_year = case_when(Range == \"max\" ~ max_papers, \n                                      Range == \"min\" ~ min_papers)) %>%\n  select(-min_papers,\n         -max_papers) %>% \n  # Add a value that tells us whether a date is min or max for colouring later:\n    # Tidy the behavioural addiction labels:\n    mutate(Label = str_replace_all(Label, \"_\", \" \") %>%\n                 str_to_title())\n\n# Order the behavioural addictions based on the first year of publication\nlabel_order <- dumbbell_plot_data %>% \n  filter(Range == \"min\") %>% \n  arrange(Year) %>% \n  pull(Label)\n\n# Fix the order:\ndumbbell_plot_data$Label <- factor(dumbbell_plot_data$Label, levels = rev(label_order))\n\n# Create data for every publication year per label\nevery_year_data <- data %>%\n  filter(Label != \"behavioural_addictions\") %>%\n  group_by(Label, Year) %>%\n  summarise(n_papers = n()) %>%\n  ungroup() %>%\n  mutate(Label = str_replace_all(Label, \"_\", \" \") %>%\n                 str_to_title())\n\n  # Plot: \ndumbbell_plot_first_last <- ggplot() +\n  geom_line(data = dumbbell_plot_data, aes(x= Year, y= Label, text = Label),\n            size = 1,\n            colour=\"#666666\") +\n  geom_point(data = every_year_data, aes(x = Year, y = Label, size=sqrt(n_papers), text = paste(Label, \"\\nYear:\", Year, \"\\nNo. of publications:\", n_papers)), color=\"grey\", alpha=0.3) +\n  geom_point(data = dumbbell_plot_data, aes(x = Year, y = Label, color=Range, size=sqrt(papers_this_year), text = paste(Label, \"\\nYear:\", Year, \"\\nNo. of publications:\", papers_this_year))) +\n  scale_size_continuous(guide=\"none\") +\n  scale_color_manual(values = c(\"min\" = \"#70A377\", \"max\" = \"#50B5C8\"), guide=FALSE) +\n  plot_theme +\n  theme(axis.title = element_blank(),\n        plot.title = element_markdown(margin = margin(b = 15, t = 40)),\n        plot.caption = element_text(color = \"#289998\", margin = margin(t = 10, b = 5), hjust = .98)) + \n  labs(\n    title = sprintf(\"<span style = 'color: #70A377;'>Earliest</span> and <span style = 'color: #50B5C8;'>most recent</span> studies of \\\"behavioural addictions\\\" on PubMed\"),\n    subtitle = \"(Up to end of 2022)\",\n    caption = \"Rob Heirene (@rheirene)\"\n  )\n\n# print(dumbbell_plot_first_last)\n\n# dumbbell_plot_first_last # View static plot\n\n# We're going to turn this into an interactive plot now using ggplotly, butthis remove some of our existing theme settings, especially the fonts.  The standard way of changing the font in ggplotly  doesn't seem to work for me, and it seems like other people having the same issue. I found this workaround online (https://github.com/plotly/plotly.R/issues/2117) which I now use below to load and use the correct font once this becomes a ggplotly:\n\n# Get the URL for the \"Reem Kufi\" font from Google Fonts:\nreem_kufi_file <- showtextdb::google_fonts(\"Reem Kufi\")$regular_url \n\n# Create custom CSS:\nreem_kufi_css <- paste0(\n  \"<style type = 'text/css'>\",\n    \"@font-face { \",\n      \"font-family: 'Reem Kufi'; \", # Use the exact name as it appears in Google Fonts\n      \"src: url('\", reem_kufi_file, \"'); \",\n    \"}\",\n  \"</style>\"\n)\n\n# Convert static plot to ggplotly format and adjust theme settings where required: \ndumbbell_plot_first_last_ggplotly <- ggplotly(dumbbell_plot_first_last,\n                                              tooltip = 'text') %>% \n  hide_legend() %>%\n  plotly::layout(margin = list(t = 90), # Increase top margin\n                 font = list(family = \"Reem Kufi\"),\n                 title = list(x = 0, y = 0.945), # Adjust x and y to position the title\n    hoverlabel = list(font = list(family = \"Reem Kufi\")\n                 \n))\n\n# Add the CSS as a dependency for the plotly plot:\ndumbbell_plot_first_last_ggplotly$dependencies <- c(\n  dumbbell_plot_first_last_ggplotly$dependencies,\n  list(\n    htmltools::htmlDependency(\n      name = \"reem-kufi-font\", \n      version = \"0\",  \n      src = \"\",\n      head = reem_kufi_css)))\n\n# Display plot:\nsaveWidget(dumbbell_plot_first_last_ggplotly, 'dumbbell_plot.html')\n```\n:::\n\n```{=html}\n<iframe src=\"dumbbell_plot.html\" class=\"fade-inhtml\" width=\"100%\" height=\"750\" style=\"border:none;\"></iframe>\n```\n\n \n\nThe size of the dots in the above plot correspond to the number of publications it that year for the addiction. After sorting the visuals with \\`ggplot2\\`, I used to the great \\`ggplotly\\` package to make it interactive---hover over any of the dots to see more information about what was going on that year for each addiction.\n\n::: {.callout-tip collapse=\"true\" icon=\"false\"}\n## Expand for session information\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Get session info\"}\nsession_info(pkgs = \"attached\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.1 (2023-06-16 ucrt)\n os       Windows 10 x64 (build 19045)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_United Kingdom.utf8\n ctype    English_United Kingdom.utf8\n tz       Europe/London\n date     2023-08-27\n pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version   date (UTC) lib source\n av          * 0.8.3     2023-02-05 [1] CRAN (R 4.3.0)\n Cairo       * 1.6-0     2022-07-05 [1] CRAN (R 4.3.0)\n dplyr       * 1.1.2     2023-04-20 [1] CRAN (R 4.3.1)\n forcats     * 1.0.0     2023-01-29 [1] CRAN (R 4.3.1)\n gganimate   * 1.0.8     2022-09-08 [1] CRAN (R 4.3.1)\n ggplot2     * 3.4.2     2023-04-03 [1] CRAN (R 4.3.1)\n ggtext      * 0.1.2     2022-09-16 [1] CRAN (R 4.3.1)\n gifski      * 1.12.0-1  2023-06-08 [1] CRAN (R 4.3.0)\n groundhog   * 3.1.0     2023-05-05 [1] CRAN (R 4.3.1)\n gt          * 0.9.0     2023-03-31 [1] CRAN (R 4.3.1)\n gtExtras    * 0.4.5     2022-11-28 [1] CRAN (R 4.3.1)\n htmlwidgets * 1.6.2     2023-03-17 [1] CRAN (R 4.3.1)\n lubridate   * 1.9.2     2023-02-10 [1] CRAN (R 4.3.1)\n plotly      * 4.10.2    2023-06-03 [1] CRAN (R 4.3.1)\n png         * 0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n purrr       * 1.0.1     2023-01-10 [1] CRAN (R 4.3.1)\n RCurl       * 1.98-1.12 2023-03-27 [1] CRAN (R 4.3.1)\n readr       * 2.1.4     2023-02-10 [1] CRAN (R 4.3.1)\n rmarkdown   * 2.23      2023-07-01 [1] CRAN (R 4.3.1)\n scico       * 1.4.0     2023-05-30 [1] CRAN (R 4.3.0)\n sessioninfo * 1.2.2     2021-12-06 [1] CRAN (R 4.3.1)\n showtext    * 0.9-6     2023-05-03 [1] CRAN (R 4.3.1)\n showtextdb  * 3.0       2020-06-04 [1] CRAN (R 4.3.1)\n stringr     * 1.5.0     2022-12-02 [1] CRAN (R 4.3.1)\n sysfonts    * 0.8.8     2022-03-13 [1] CRAN (R 4.3.1)\n tibble      * 3.2.1     2023-03-20 [1] CRAN (R 4.3.1)\n tidyr       * 1.3.0     2023-01-24 [1] CRAN (R 4.3.1)\n tidyverse   * 2.0.0     2023-02-22 [1] CRAN (R 4.3.1)\n transformr  * 0.1.4     2022-08-18 [1] CRAN (R 4.3.1)\n\n [1] C:/Users/rheirene/AppData/Local/R/win-library/4.3\n [2] C:/Program Files/R/R-4.3.1/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n\n:::\n\n------------------------------------------------------------------------\n\n\n```{=html}\n<script src=\"https://giscus.app/client.js\"\n        data-repo=\"rheirene/Quarto_Website\"\n        data-repo-id=\"R_kgDOJ0d4fA\"\n        data-category-id=\"DIC_kwDOJ0d4fM4CXv7I\"\n        data-mapping=\"pathname\"\n        data-strict=\"0\"\n        data-reactions-enabled=\"1\"\n        data-emit-metadata=\"0\"\n        data-input-position=\"bottom\"\n        data-theme=\"dark_dimmed\"\n        data-lang=\"en\"\n        crossorigin=\"anonymous\"\n        async>\n</script\n```\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}