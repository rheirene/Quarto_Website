<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rob Heirene">
<meta name="dcterms.date" content="2023-08-21">
<meta name="description" content="An interactive chart of strategies to prevent gambling harms">

<title>Rob Heirene - How can we prevent gambling harms?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../files/logo.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Rob Heirene - How can we prevent gambling harms?">
<meta property="og:description" content="An interactive chart of strategies to prevent gambling harms">
<meta property="og:image" content="sunburst.png">
<meta property="og:site-name" content="Rob Heirene">
<meta name="twitter:title" content="Rob Heirene - How can we prevent gambling harms?">
<meta name="twitter:description" content="An interactive chart of strategies to prevent gambling harms">
<meta name="twitter:image" content="sunburst.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Rob Heirene</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html" rel="" target="">
 <span class="menu-text">Addiction Science Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publication.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="mailto:robheirene@gmail.com" title="" class="quarto-navigation-tool px-1" aria-label="email"><i class="bi bi-envelope-fill"></i></a>
    <a href="https://github.com/rheirene" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://scholar.google.co.uk/citations?user=2bz0qnsAAAAJ&amp;hl=en" title="" class="quarto-navigation-tool px-1" aria-label="Scholar"><i class="bi bi-mortarboard-fill"></i></a>
    <a href="https://osf.io/atwg5/" title="" class="quarto-navigation-tool px-1" aria-label="osf.io"><i class="bi bi-door-open"></i></a>
    <a href="https://twitter.com/RHeirene" title="" class="quarto-navigation-tool px-1" aria-label="twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://www.linkedin.com/in/robert-heirene/" title="" class="quarto-navigation-tool px-1" aria-label="linkedin"><i class="bi bi-linkedin"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">How can we prevent gambling harms?</h1>
                  <div>
        <div class="description">
          An interactive chart of strategies to prevent gambling harms
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Gambling</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rob Heirene </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 21, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#athat-adds-real-value-to-the-world." id="toc-athat-adds-real-value-to-the-world." class="nav-link active" data-scroll-target="#athat-adds-real-value-to-the-world.">Athat adds real value to the world.</a></li>
  <li><a href="#prevention-strategies-visualised" id="toc-prevention-strategies-visualised" class="nav-link" data-scroll-target="#prevention-strategies-visualised">Prevention strategies visualised</a></li>
  <li><a href="#the-evidence" id="toc-the-evidence" class="nav-link" data-scroll-target="#the-evidence">The evidence</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="athat-adds-real-value-to-the-world." class="level3">
<h3 class="anchored" data-anchor-id="athat-adds-real-value-to-the-world.">Athat adds real value to the world.</h3>
<p>With this in mind, I’m thinking about problem gambling prevention a lot at the moment and where to place my focus. To help with this, I’ve started mapping all the existing harm prevention strategies used in practice or proposed in the gambling literature.</p>
</section>
<section id="prevention-strategies-visualised" class="level3">
<h3 class="anchored" data-anchor-id="prevention-strategies-visualised">Prevention strategies visualised</h3>
<p>To make this process a little more interesting for me and anyone who reads this, I’ve been playing around with the <code>plotly</code> R package to present my catalogue of prevention strategies in a visual and interactive way.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Work in progress
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please note that I’ve only just started making the chart and I’m conscious that it currently provides a <strong>very incomplete picture</strong> of the strategies available. I will be reading around and adding more strategies and information over the next few months (starting July 2023).</p>
<p>That said, please feel free to suggest some strategies or edits using the comments section at the end (or you can <a href="mailto:robheirene@gmail.com">send me an email</a>).</p>
</div>
</div>
<p>Below is what I have so far, visualised as a sunburst chart. Hover over each category or strategy to reveal descriptions of each, and <span style="color:#289998; font-weight: bold;"><strong>click on the bars to see more</strong></span>. It’s best viewed on a PC/mac or tablet (if you are on mobile, turn it to landscape mode).</p>
<div class="cell">
<details>
<summary>Show set-up code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the groundhog package to ensure consistency of the package versions used here:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("groundhog") # Install</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(groundhog) <span class="co"># Load</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># List desired packages:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="co"># Clean, organise, and visualise data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">'plotly'</span>, <span class="co"># Add interactive elements to figures</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">'sysfonts'</span>, <span class="co"># Special fonts for figures</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">'showtext'</span>, <span class="co"># Special fonts for figures</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">'htmlwidgets'</span>) <span class="co"># Make plotly plots HTML format for rendering in Quarto</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load desired package with versions specific to project start date:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">groundhog.library</span>(packages, <span class="st">"2023-06-05"</span>) <span class="co"># Set Slightly earlier than start date as some of the plotly dependency packages wouldn't load properly with date as 07/07/2023</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Load new font for figures/graphs</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Reem Kufi"</span>, <span class="st">"Reem Kufi"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>(<span class="at">enable =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code used to create chart</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load manually input data:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>gam_prevention_data<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"gamb_prevention_data.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Layer<span class="sc">:</span>Description) <span class="co"># Warning, something as simple as an apostrophe and this dataset can cause it to not play nice</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># gam_prevention_data&lt;- read.csv("posts/2023-gambling-harms-chart/gamb_prevention_data.csv") %&gt;% select(Layer:Description) # Load in session</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sunburst chart:</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a> gam_prevention_sunburst<span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(gam_prevention_data,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ids =</span> <span class="sc">~</span>IDs,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels =</span> <span class="sc">~</span>Label,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">parents =</span> <span class="sc">~</span>Parents,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hoverinfo =</span> <span class="st">"text"</span>,  <span class="co"># Needed for below argument to work</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hovertext =</span> <span class="sc">~</span>Description,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="st">'sunburst'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">maxdepth =</span> <span class="dv">3</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">insidetextorientation =</span> <span class="st">'radial'</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">'#002B36'</span>)),  <span class="co"># Adjust border size + color</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>   plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">colorway =</span> <span class="fu">c</span>(<span class="st">"#289998"</span>, <span class="st">"#288D98"</span>, <span class="st">"#287699"</span>, <span class="st">"#7E6F98"</span>, <span class="st">"#BFB3C0"</span>, <span class="st">"#FFF7E7"</span>, <span class="st">"#E6C97F"</span>, <span class="st">"#8C8033"</span>, <span class="st">"#7E9F6E"</span>, <span class="st">"#65BBA3"</span>, <span class="st">"#94C8C0"</span>, <span class="st">"#998F28"</span>, <span class="st">"#62A899"</span>, <span class="st">"#986289"</span>, <span class="st">"#289970"</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"Reem Kufi"</span>, <span class="co"># change main font</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">"#FFF7E7"</span>), <span class="co"># Set main font so the central layer text can be seen</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">paper_bgcolor =</span> <span class="st">'#002B36'</span>, <span class="co"># background consistent with site</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot_bgcolor =</span> <span class="st">'#002B36'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">hoverlabel =</span> <span class="fu">list</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Reem Kufi"</span>)))  <span class="co"># Increase the font size and family for hover text)</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># The standard way of changing the font in ggplotly doesn't seem to work for me, and it seems like other people having the same issue. I found this workaround online (https://github.com/plotly/plotly.R/issues/2117) which I now use below to load and use the correct font in our ggplotly:</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the URL for the "Reem Kufi" font from Google Fonts:</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>reem_kufi_file <span class="ot">&lt;-</span> showtextdb<span class="sc">::</span><span class="fu">google_fonts</span>(<span class="st">"Reem Kufi"</span>)<span class="sc">$</span>regular_url </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom CSS:</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>reem_kufi_css <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&lt;style type = 'text/css'&gt;"</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"@font-face { "</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">"font-family: 'Reem Kufi'; "</span>, </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">"src: url('"</span>, reem_kufi_file, <span class="st">"'); "</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"}"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&lt;/style&gt;"</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the CSS as a dependency for the plotly plot:</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>gam_prevention_sunburst<span class="sc">$</span>dependencies <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  gam_prevention_sunburst<span class="sc">$</span>dependencies,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    htmltools<span class="sc">::</span><span class="fu">htmlDependency</span>(</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"reem-kufi-font"</span>, </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">version =</span> <span class="st">"0"</span>,  </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">src =</span> <span class="st">""</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">head =</span> reem_kufi_css)))</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ****Uncomment to update****</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot as a HTML file (it doesn't render well with quarto otherwise):</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(gam_prevention_sunburst, 'rheirene/posts/2023-gambling-harms-chart/sunburst_fig.html')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<iframe src="sunburst_fig.html" class="fade-inhtml" width="100%" height="750" style="border:none;"></iframe>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recreating the chart
</div>
</div>
<div class="callout-body-container callout-body">
<p>I’ve included the <code>R code</code> used to create the chart in the drop-down sections just above it. Feel free to recreate it (the data are on the <a href="https://github.com/rheirene/Quarto_Website">Github repo</a> for this site) or adapt the code to your own chart, but please credit me if you do :)</p>
</div>
</div>
</section>
<section id="the-evidence" class="level3">
<h3 class="anchored" data-anchor-id="the-evidence">The evidence</h3>
<p>As I (re-)read the literature on this topic, I’m also creating a record of relevant studies and resources relating to each prevention strategy. <strong>This section is even less developed than the chart, so the same call for suggestions applies.</strong></p>
<p>There will eventually be a lot of information presented here, so I’ve hidden the text for each prevention strategy inside expandable boxes for easier navigation.</p>
<section id="consumer-protection-tools" class="level4">
<h4 class="anchored" data-anchor-id="consumer-protection-tools">Consumer protection tools</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Self-assessments
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The authors in <a href="https://doi.org/10.1007/s10899-023-10230-1">this study</a> collected retrospective data from a European gambling site that offers their customers the ability to estimate their recent gambling behaviour and expenditure (“Recent gambling self assessment” in the chart), including amount wagered, deposited, and withdrawn, as well as play duration in hours (all over the last 30 days). They compared peoples’ (n = 639) deposit amount before and after this self-assessment and found a significant reduction that wasn’t affected by whether people underestimated, overestimated, or correctly estimated their past 30 day deposit amount. While the reduction was quite substantial (averaged between -$85 to $-300 across the three estimation groups), there was no control/comparator group and so we do not know whether this change would have occurred in the absence of this self-assessment (just regression to the mean?). Also, as the authors note, the group of people who voluntarily and actively took time to complete this self-assessment may have already made the decision to decrease their gambling before taking the self-assessment.</p>
<ul>
<li>Auer, M., Hopfgartner, N., Helic, D., &amp; others. (2023). Self-reported Deposits Versus Actual Deposits in Online Gambling: An Empirical Study. <em>J Gambl Stud.</em> <a href="https://doi.org/10.1007/s10899-023-10230-1" class="uri">https://doi.org/10.1007/s10899-023-10230-1</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="restrictions" class="level4">
<h4 class="anchored" data-anchor-id="restrictions">Restrictions</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Global loss limits
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>A survey (n = 2352) of Norsk Tipping (a Norwegian Government-owned gambling operator) customers’ perspectives on the recently implemented global loss limit of NOK 20,000 per month (~$2450USD; <a href="https://doi.org/10.1007/s11469-018-9892-x">Auer et al., 2018</a>). It’s slightly unclear, but it appears that players also had to set a daily and monthly loss limit specific to game types (e.g., online casino, bingo), but the all-game global limit of 20k NOK per month still applied. Most found the new limits easy to understand (76%) and had positive attitudes towards them (79%). Only 25% agreed entirely or in part that a maximum loss limit was relevant to the, and 6% of green players (i.e., low risk of problem gambling) and 16% of red players (i.e., high risk of problem gambling) said they continued to gamble with other companies after reaching their limit.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Global stake limits
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>This <a href="https://www.gamblingcommission.gov.uk/about-us/guide/consumer-voice-2020-exploring-online-staking">UK Gambling Commission report</a> from 2020 discusses consumer perspectives on stake limits (n = 32, weekly gamblers). Low-risk participants (i.e., PGSI score 0-2) were in favour of stake limits, but wary of losing the fun of gambling and preferred to limit stakes on non-skill games. There was more disagreement within moderate risk participants (i.e., PGSI score 3-7), but they mostly agreed with the idea of stake limits, arguing that multiple variables need to be considered when determining the limit amount (e.g., household income &amp; state of mind) and that players should be able to overrule limits. High risk gamblers (i.e., PGSI score ≥8) were positive about stake limits believed the responsibility to protect players layed firmly on the shoulders of betting firms. Overall, participants were more positive about loss limits than stake limits.</p></li>
<li><p>It seems that a lot of online gambling sites indirectly impose stake limits by having maximum payout amounts (e.g., £100,000). Payout limits vary from site to site and across activities, but these operator-protecting restrictions (which are sometimes reduced for big winners…) can limit customer stakes. Read more <a href="https://bettingsites.org.uk/guides/betting-limits-maximum-payouts/">here</a>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="operator-communications" class="level4">
<h4 class="anchored" data-anchor-id="operator-communications">Operator communications</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Messaging (general)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>This <a href="https://www.gamblingcommission.gov.uk/about-us/guide/consumer-voice-2020-exploring-online-staking">UK Gambling Commission report</a> from 2020 discusses consumer perspectives on safer gambling communications (n = 32, weekly gamblers). Low-risk participants (i.e., PGSI score 0-2) were likely to say that safer gambling messaging was effective, but saw it as not relevant for them and therefore they opted out of such messaging. Moderate risk gamblers (i.e., PGSI score 3-7) opted out of messaging also as they didn’t feel it was for them and didn’t like to be reminded to “gamble responsibly” because they felt in control of their gambling. High risk gamblers (i.e., PGSI score ≥8) stated that highlighting losses could push people to spend more money and that such communications may need to be replaced by limits to be effective. In general, safer gambling messages were viewed as being easy to opt out of and easy to ignore, warranting actual barriers to risky play (i.e., limits).</p></li>
<li><p>This <a href="https://doi.org/10.1016/S2468-2667(21)00279-6">2022 study</a> including 3 pre-registered randomized experiments (n ≈ 500 per study) found no evidence for a protective effect (on spending behaviour) of the “When the fun stops, stop” warning message commonly used by UK gambling companies. Participants were UK adults who had previously gambled. They were given a monetary endowment with which they were allowed to bet on either an online roulette game (Study 2) or real soccer events (Study 1 &amp; 3). The presence and presentation of the warning message varied between participants in each study.</p>
<ul>
<li>Newall, P. W. S., Weiss-Cohen, L., Singmann, H., Walasek, L., &amp; Ludvig, E. A. (2022). Impact of the ‘When the Fun Stops, Stop’ gambling message on online gambling behaviour: A randomised, online experimental study. <em>The Lancet Public Health</em>, 7(5), e437–e446. <a href="https://doi.org/10.1016/S2468-2667(21)00279-6" class="uri">https://doi.org/10.1016/S2468-2667(21)00279-6</a>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="risk-assessment" class="level4">
<h4 class="anchored" data-anchor-id="risk-assessment">Risk assessment</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Player monitoring
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>This <a href="https://doi.org/10.1111/add.16179">2023 study</a> collected PGSI responses from nearly 10,000 Canadians who held anaccount with Loto-Québec (a provincial Crown Corporation) in Quebec, Canada. They also collected their preceding 12 months of behavioural account data from Loto-Québec and used this data to try and predict PGSI scores (5+ or 8+) using six different machine learning models: Decision trees, K-nearest neighbours, Support vector machines, logistic regression, artificial neural networks, Random forests. The Random Forest model had the highest predictive accuracy (AUC = 84.3% for 5+; 82.5% for 8+). Unlike most studies that try to do something similar, this one actually shares the underlying code and a wealth of <a href="https://onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1111%2Fadd.16179&amp;file=add16179-sup-0001-LQ+Paper+Supplementary+Materials+V5.0_R2.pdf">supplemental detail</a> regarding methods and results (well done to the authors!).</p>
<ul>
<li>Murch, WS, Kairouz, S, Dauphinais, S, Picard, E, Costes, J-M, French, M. Using machine learning to retrospectively predict self-reported gambling problems in Quebec. <em>Addiction</em>. 2023; 118( 8): 1569– 1578. <a href="https://doi.org/10.1111/add.16179%20https://doi.org/10.1111/add.16179">https://doi.org/10.1111/add.16179</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="public-health-campaigns" class="level4">
<h4 class="anchored" data-anchor-id="public-health-campaigns">Public health campaigns</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advertising campaigns
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>This <a href="https://doi.org/10.1016/j.puhe.2023.08.009">2023 study</a> discusses the ‘Odds Are: They Win’ messaging campaign implemented in the UK (Manchester) towards the end of 2022 ( to coincide with the Football World Cup). The authors call this campaign a “disruptive innovation”, given the focus of messages on the gambling industry, rather than individual responsibility. Several different advertisements were displayed over a three-month period on social media and in Greater Manchester’s tram system and coffee shops. Look at the paper to see how the advertisements were displayed, but they included things like “<em>Gambling harm is not only financial, it can impact your health, well-being, and relationships</em>” and “<em>The main purpose of gambling companies to maximise profit, generated through customer losse</em>s”. A service evaluation of the programme (the results of which can be found <a href="https://greatermanchester-ca.gov.uk/media/7896/odds-are-they-win-campaign-report-summary.pdf">here</a>) suggested the campaign had a wide reach (16,000+ unique clicks to landing page). This all sounds great and I support such messages, but there’s no comparison/control so we can’t draw much from this article about this type of messaging just yet.</p>
<ul>
<li>Mills, T., Grimes, K., Caddick, E., Jenkins, C.l., Evans, J., Moss, A., Wills, J., &amp; Sykes, S. (2023). ‘Odds Are: They Win’: a disruptive messaging innovation for challenging harmful products and practices of the gambling industry. Public Health, 224, 41-44, <a href="https://doi.org/10.1016/j.puhe.2023.08.009https://doi.org/10.1016/j.puhe.2023.08.009">https://doi.org/10.1016/j.puhe.2023.08.009</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="blocking-tools" class="level4">
<h4 class="anchored" data-anchor-id="blocking-tools">Blocking tools</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bank gambling blocks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This <a href="https://d1ygf46rsya1tb.cloudfront.net/prod/uploads/2023/06/GRFH_Bank_Gambling_Blocks_Workshop_Summary.pdf">2023 report</a> from GamCare summarises the outcomes and recommendations from a virtual workshop on bank gambling block involving researchers, representatives from the financial and gambling industries, gambling support services, debt and money advice services, and individuals with lived experience. They make a number of recommendations for how banks can improve their blocking tools not discussed here. Key findings:</p>
<ul>
<li><p>Many UK banks now offer gambling blocks, but awareness of these tools is low.</p></li>
<li><p>The ease of accessing and using the blocks varies across banks.</p></li>
<li><p>Most banks allow the customers to self deactivate the blocks using their mobile app, although there is to be gay 48 or 72 hour cooling off period before this takes effect. Some banks require customers to speak to their customer support team before turning off the block, increasing friction.</p></li>
<li><p>There are many loopholes which allow customers with a bank gambling block to continue gambling (e.g., e-wallets; overseas gambling).</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="product-design" class="level4">
<h4 class="anchored" data-anchor-id="product-design">Product design</h4>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Limit anchors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>This <a href="https://www.bi.team/publications/applying-behavioural-insights-to-design-safer-gambling-tools/">2021 report</a> by the UK Behavioural Insights Team involved a trial of different deposit limit anchors (i.e., potential limit values presented in a dropdown menu to consumers when first setting their limit) with three arms: [1] a business as usual condition (with anchors ranging from £5 to £100,000), [2] anchors only as high as £250, and [3] a free text box to enter a desired limit with no visible anchors. Existing bet 365 customers about deposit limits were randomly selected to be sent prompts encouraging them to set limits between January–April 2020. 1,731 participants split roughly evenly across the 3 arms set limits. Customers in the control (arm 1) group set the highest limits (Mdn = £14.3, M = £1601), followed by those in the reduced anchor group (arm 2; Mdn = £8.3, M = £230.8), and the free-text box group (arm 3; Mdn = £7.1, M = £308.78). Customers in the 2nd and 3rd arm were slightly more likely to remove their limit in the trial period, but the difference was not statistically significant.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Friction based strategies
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<hr>
<script src="https://giscus.app/client.js" data-repo="rheirene/Quarto_Website" data-repo-id="R_kgDOJ0d4fA" data-category-id="DIC_kwDOJ0d4fM4CXv7I" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="dark_dimmed" data-lang="en" crossorigin="anonymous" async="">
</script>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{heirene2023,
  author = {Heirene, Rob},
  title = {How Can We Prevent Gambling Harms?},
  date = {2023-08-21},
  url = {https://robheirene.netlify.app/posts/2023-gambling-harms-chart},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-heirene2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Heirene, Rob. 2023. <span>“How Can We Prevent Gambling Harms? .”</span>
August 21, 2023. <a href="https://robheirene.netlify.app/posts/2023-gambling-harms-chart">https://robheirene.netlify.app/posts/2023-gambling-harms-chart</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Rob Heirene (<a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>)</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">View source code on <a href="https://github.com/rheirene/Quarto_Website">Github</a></div>
  </div>
</footer>



</body></html>